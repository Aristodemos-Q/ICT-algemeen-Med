"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1461],{1090:(e,t,r)=>{r.d(t,{AuthProvider:()=>d,A:()=>c});var s=r(5155),a=r(2115),n=r(2881),o=r(5695);async function i(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let a=1;a<=r;a++)try{return await e()}catch(e){if(t=e,console.warn("Attempt ".concat(a," failed:"),t.message),t.message.includes("Invalid login credentials")||t.message.includes("User not found")||t.message.includes("Invalid email")||t.message.includes("Signup is disabled"))throw t;if((t.message.includes("Failed to fetch")||t.message.includes("Network connection failed")||t.message.includes("timeout")||t.message.includes("Request timeout")||"TypeError"===t.name||"AbortError"===t.name)&&a<r){console.log("Retrying in ".concat(s,"ms... (").concat(a,"/").concat(r,")")),await new Promise(e=>setTimeout(e,s)),s*=1.5;continue}break}throw t}let l=(0,a.createContext)(void 0);function d(e){var t;let{children:r}=e,[d,c]=(0,a.useState)(null),[u,m]=(0,a.useState)(!0),[g,f]=(0,a.useState)(null),[h,p]=(0,a.useState)(!1),w=(0,o.useRouter)();(0,a.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:r},error:s}=await n.y.supabase.auth.getSession();if(s)console.error("Error getting session:",s),f("Failed to initialize authentication");else if(e){var t;c(null!=(t=null==r?void 0:r.user)?t:null)}}catch(t){console.error("Error initializing auth:",t),e&&f("Failed to initialize authentication")}finally{e&&(m(!1),p(!0))}})();let{data:{subscription:t}}=n.y.supabase.auth.onAuthStateChange(async(t,r)=>{var s,a;console.log("\uD83D\uDD04 Auth state change:",{event:t,hasUser:!!(null==r?void 0:r.user),userEmail:null==r||null==(s=r.user)?void 0:s.email}),e&&(c(null!=(a=null==r?void 0:r.user)?a:null),m(!1),"SIGNED_IN"===t&&(null==r?void 0:r.user)?(console.log("✅ SIGNED_IN event - checking for redirect"),setTimeout(()=>{"/login"===window.location.pathname?(console.log("\uD83C\uDFE0 No custom redirect detected, going to dashboard"),w.push("/dashboard")):console.log("✅ Custom redirect detected, staying on current page")},300)):"SIGNED_OUT"===t&&(console.log("\uD83D\uDEAA SIGNED_OUT event - redirecting to login"),w.push("/login")))});return()=>{e=!1,t.unsubscribe()}},[w]);let b={user:d,loading:u,login:async(e,t)=>{try{var r;f(null),m(!0),console.log("AuthContext login attempt:",{email:e});try{let e=await fetch("".concat("https://tuqlyoimberycjtdkivm.supabase.co","/rest/v1/"),{method:"HEAD",headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR1cWx5b2ltYmVyeWNqdGRraXZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzMjcwNTIsImV4cCI6MjA2NTkwMzA1Mn0.O1zFRbvkHq-1HMAHFXGU8uNVGcEgVCDESYWVbWwQZfI"}});console.log("Connectivity test successful:",e.status)}catch(e){throw console.error("Connectivity test failed:",e),Error("Kan geen verbinding maken met de server. Controleer je internetverbinding.")}let{data:s,error:a}=await i(async()=>await n.y.supabase.auth.signInWithPassword({email:e,password:t}),3,1e3);if(console.log("AuthContext login response:",{hasUser:!!s.user,userEmail:null==(r=s.user)?void 0:r.email,hasSession:!!s.session,errorMessage:null==a?void 0:a.message}),a){if(console.error("Login error details:",{message:a.message,status:a.status,name:a.name}),a.message.includes("Invalid login credentials"))throw Error("Ongeldige inloggegevens. Controleer je e-mailadres en wachtwoord.");if(a.message.includes("Too many requests"))throw Error("Te veel inlogpogingen. Probeer het over een paar minuten opnieuw.");if(a.message.includes("User not found"))throw Error("Geen account gevonden met dit e-mailadres. Registreer eerst een account.");else if(a.message.includes("Invalid email"))throw Error("Ongeldig e-mailadres format.");else if(a.message.includes("Signup is disabled"))throw Error("Registratie is momenteel uitgeschakeld. Neem contact op met de beheerder.");else if(a.message.includes("Failed to fetch")||a.message.includes("Network connection failed"))throw Error("Netwerkverbinding mislukt. Controleer je internetverbinding en probeer opnieuw.");else throw Error("Login fout: ".concat(a.message))}if(!s.user)throw Error("Login failed: No user data received");console.log("✅ Login successful, setting user:",s.user.email),c(s.user),console.log("⏳ Waiting for onAuthStateChange to handle redirect...")}catch(t){let e=t instanceof Error?t.message:"Login failed";throw console.error("AuthContext login error:",e),f(e),m(!1),t}},logout:async()=>{try{f(null);let{error:e}=await n.y.supabase.auth.signOut();if(e)throw e;c(null),w.push("/login")}catch(e){throw f(e instanceof Error?e.message:"Logout failed"),e}},error:g,clearError:()=>{f(null)},isAdmin:!!d&&((null==(t=d.user_metadata)?void 0:t.role)==="admin"||"qdelarambelje@gmail.com"===d.email||"admin@bvfloriande.nl"===d.email)};return(0,s.jsx)(l.Provider,{value:b,children:r})}function c(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2523:(e,t,r)=>{r.d(t,{p:()=>o});var s=r(5155),a=r(2115),n=r(9434);let o=a.forwardRef((e,t)=>{let{className:r,type:a,...o}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-background px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...o})});o.displayName="Input"},2881:(e,t,r)=>{r.d(t,{y:()=>a});var s=r(6927);let a={supabase:s.N,async resetPassword(e){let{error:t}=await s.N.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(t)throw t;return{success:!0}},async signUp(e,t,r){if(t.length<8)throw Error("Wachtwoord moet minimaal 8 tekens lang zijn");let{data:a,error:n}=await s.N.auth.signUp({email:e,password:t,options:{data:r}});if(n)throw n;return{data:a,error:null}},async signIn(e,t){let{data:r,error:a}=await s.N.auth.signInWithPassword({email:e,password:t});if(a)throw a;return r},async signOut(){let{error:e}=await s.N.auth.signOut();if(e)throw e},async getCurrentUser(){let{data:{user:e},error:t}=await s.N.auth.getUser();if(t)throw t;return e},resendConfirmation:async e=>(console.log("Email confirmation is disabled for development"),{success:!0}),async updatePassword(e){if(e.length<8)throw Error("Wachtwoord moet minimaal 8 tekens lang zijn");let{error:t}=await s.N.auth.updateUser({password:e});if(t)throw t;return{success:!0}}}},8539:(e,t,r)=>{r.d(t,{T:()=>o});var s=r(5155),a=r(2115),n=r(9434);let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});o.displayName="Textarea"},9409:(e,t,r)=>{r.d(t,{bq:()=>m,eb:()=>p,gC:()=>h,l6:()=>c,yv:()=>u});var s=r(5155),a=r(2115),n=r(8715),o=r(6474),i=r(7863),l=r(5196),d=r(9434);let c=n.bL;n.YJ;let u=n.WT,m=a.forwardRef((e,t)=>{let{className:r,children:a,...i}=e;return(0,s.jsxs)(n.l9,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...i,children:[a,(0,s.jsx)(n.In,{asChild:!0,children:(0,s.jsx)(o.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=n.l9.displayName;let g=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...a,children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})});g.displayName=n.PP.displayName;let f=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...a,children:(0,s.jsx)(o.A,{className:"h-4 w-4"})})});f.displayName=n.wn.displayName;let h=a.forwardRef((e,t)=>{let{className:r,children:a,position:o="popper",...i}=e;return(0,s.jsx)(n.ZL,{children:(0,s.jsxs)(n.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:o,...i,children:[(0,s.jsx)(g,{}),(0,s.jsx)(n.LM,{className:(0,d.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,s.jsx)(f,{})]})})});h.displayName=n.UC.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.JU,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...a})}).displayName=n.JU.displayName;let p=a.forwardRef((e,t)=>{let{className:r,children:a,...o}=e;return(0,s.jsxs)(n.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...o,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.VF,{children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})}),(0,s.jsx)(n.p4,{children:a})]})});p.displayName=n.q7.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",r),...a})}).displayName=n.wv.displayName}}]);