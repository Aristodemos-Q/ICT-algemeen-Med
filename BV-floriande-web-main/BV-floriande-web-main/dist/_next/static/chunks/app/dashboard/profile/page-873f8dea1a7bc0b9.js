(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[399],{245:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(5155),a=r(2115),n=r(1090),i=r(6117),l=r(6695),o=r(2523),d=r(5057),c=r(285),u=r(5365),m=r(5339),g=r(1007),f=r(8883),h=r(4229),p=r(1153),v=r(5495);let x=p.z.object({name:p.z.string().min(2,"Naam moet minimaal 2 tekens bevatten"),email:p.z.string().email("Voer een geldig e-mailadres in")});function b(){let{user:e,loading:t}=(0,n.A)(),[r,b]=(0,a.useState)(""),[w,y]=(0,a.useState)(""),[N,j]=(0,a.useState)(""),[E,k]=(0,a.useState)(!1),[A,C]=(0,a.useState)(!1),[I,R]=(0,a.useState)({});(0,a.useEffect)(()=>{if(e){var t;b((null==(t=e.user_metadata)?void 0:t.name)||""),y(e.email||"")}},[e]);let S=()=>{try{return x.parse({name:r,email:w}),R({}),!0}catch(e){if(e instanceof p.z.ZodError){let t={};e.errors.forEach(e=>{t[e.path[0]]=e.message}),R(t)}return!1}},F=async t=>{if(t.preventDefault(),S()&&e){C(!0),j(""),k(!1);try{await v.Dv.updateUser(e.id,{name:r,email:w}),k(!0)}catch(e){j((null==e?void 0:e.message)||"Er is een fout opgetreden bij het bijwerken van je profiel")}finally{C(!1)}}};return(0,s.jsx)(i.A,{children:(0,s.jsx)("div",{className:"container mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Mijn profiel"})}),(0,s.jsxs)(l.Zp,{children:[(0,s.jsxs)(l.aR,{children:[(0,s.jsx)(l.ZB,{children:"Persoonlijke gegevens"}),(0,s.jsx)(l.BT,{children:"Beheer je profiel instellingen en contactgegevens."})]}),(0,s.jsx)(l.Wu,{children:(0,s.jsxs)("form",{onSubmit:F,className:"space-y-6",children:[N&&(0,s.jsxs)(u.Fc,{variant:"destructive",children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),(0,s.jsx)(u.TN,{children:N})]}),E&&(0,s.jsx)(u.Fc,{className:"bg-green-50 border-green-200",children:(0,s.jsx)(u.TN,{className:"text-green-800",children:"Je profiel is succesvol bijgewerkt!"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"name",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(g.A,{className:"h-4 w-4"}),"Naam"]})}),(0,s.jsx)(o.p,{id:"name",value:r,onChange:e=>b(e.target.value),className:I.name?"border-destructive":"",disabled:A}),I.name&&(0,s.jsx)("p",{className:"text-destructive text-xs mt-1",children:I.name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"email",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(f.A,{className:"h-4 w-4"}),"E-mailadres"]})}),(0,s.jsx)(o.p,{id:"email",type:"email",value:w,onChange:e=>y(e.target.value),className:I.email?"border-destructive":"",disabled:A}),I.email&&(0,s.jsx)("p",{className:"text-destructive text-xs mt-1",children:I.email})]}),(0,s.jsx)("div",{className:"pt-4",children:(0,s.jsx)(c.$,{type:"submit",disabled:A,children:A?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-4 w-4 mr-2 animate-spin rounded-full border-2 border-current border-t-transparent"}),"Opslaan..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Wijzigingen opslaan"]})})})]})]})})]})]})})})}},1007:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},1090:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>d,A:()=>c});var s=r(5155),a=r(2115),n=r(2881),i=r(5695);async function l(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let a=1;a<=r;a++)try{return await e()}catch(e){if(t=e,console.warn("Attempt ".concat(a," failed:"),t.message),t.message.includes("Invalid login credentials")||t.message.includes("User not found")||t.message.includes("Invalid email")||t.message.includes("Signup is disabled"))throw t;if((t.message.includes("Failed to fetch")||t.message.includes("Network connection failed")||t.message.includes("timeout")||t.message.includes("Request timeout")||"TypeError"===t.name||"AbortError"===t.name)&&a<r){console.log("Retrying in ".concat(s,"ms... (").concat(a,"/").concat(r,")")),await new Promise(e=>setTimeout(e,s)),s*=1.5;continue}break}throw t}let o=(0,a.createContext)(void 0);function d(e){var t;let{children:r}=e,[d,c]=(0,a.useState)(null),[u,m]=(0,a.useState)(!0),[g,f]=(0,a.useState)(null),[h,p]=(0,a.useState)(!1),v=(0,i.useRouter)();(0,a.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:r},error:s}=await n.y.supabase.auth.getSession();if(s)console.error("Error getting session:",s),f("Failed to initialize authentication");else if(e){var t;c(null!=(t=null==r?void 0:r.user)?t:null)}}catch(t){console.error("Error initializing auth:",t),e&&f("Failed to initialize authentication")}finally{e&&(m(!1),p(!0))}})();let{data:{subscription:t}}=n.y.supabase.auth.onAuthStateChange(async(t,r)=>{var s,a;console.log("\uD83D\uDD04 Auth state change:",{event:t,hasUser:!!(null==r?void 0:r.user),userEmail:null==r||null==(s=r.user)?void 0:s.email}),e&&(c(null!=(a=null==r?void 0:r.user)?a:null),m(!1),"SIGNED_IN"===t&&(null==r?void 0:r.user)?(console.log("✅ SIGNED_IN event - checking for redirect"),setTimeout(()=>{"/login"===window.location.pathname?(console.log("\uD83C\uDFE0 No custom redirect detected, going to dashboard"),v.push("/dashboard")):console.log("✅ Custom redirect detected, staying on current page")},300)):"SIGNED_OUT"===t&&(console.log("\uD83D\uDEAA SIGNED_OUT event - redirecting to login"),v.push("/login")))});return()=>{e=!1,t.unsubscribe()}},[v]);let x={user:d,loading:u,login:async(e,t)=>{try{var r;f(null),m(!0),console.log("AuthContext login attempt:",{email:e});try{let e=await fetch("".concat("https://tuqlyoimberycjtdkivm.supabase.co","/rest/v1/"),{method:"HEAD",headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR1cWx5b2ltYmVyeWNqdGRraXZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzMjcwNTIsImV4cCI6MjA2NTkwMzA1Mn0.O1zFRbvkHq-1HMAHFXGU8uNVGcEgVCDESYWVbWwQZfI"}});console.log("Connectivity test successful:",e.status)}catch(e){throw console.error("Connectivity test failed:",e),Error("Kan geen verbinding maken met de server. Controleer je internetverbinding.")}let{data:s,error:a}=await l(async()=>await n.y.supabase.auth.signInWithPassword({email:e,password:t}),3,1e3);if(console.log("AuthContext login response:",{hasUser:!!s.user,userEmail:null==(r=s.user)?void 0:r.email,hasSession:!!s.session,errorMessage:null==a?void 0:a.message}),a){if(console.error("Login error details:",{message:a.message,status:a.status,name:a.name}),a.message.includes("Invalid login credentials"))throw Error("Ongeldige inloggegevens. Controleer je e-mailadres en wachtwoord.");if(a.message.includes("Too many requests"))throw Error("Te veel inlogpogingen. Probeer het over een paar minuten opnieuw.");if(a.message.includes("User not found"))throw Error("Geen account gevonden met dit e-mailadres. Registreer eerst een account.");else if(a.message.includes("Invalid email"))throw Error("Ongeldig e-mailadres format.");else if(a.message.includes("Signup is disabled"))throw Error("Registratie is momenteel uitgeschakeld. Neem contact op met de beheerder.");else if(a.message.includes("Failed to fetch")||a.message.includes("Network connection failed"))throw Error("Netwerkverbinding mislukt. Controleer je internetverbinding en probeer opnieuw.");else throw Error("Login fout: ".concat(a.message))}if(!s.user)throw Error("Login failed: No user data received");console.log("✅ Login successful, setting user:",s.user.email),c(s.user),console.log("⏳ Waiting for onAuthStateChange to handle redirect...")}catch(t){let e=t instanceof Error?t.message:"Login failed";throw console.error("AuthContext login error:",e),f(e),m(!1),t}},logout:async()=>{try{f(null);let{error:e}=await n.y.supabase.auth.signOut();if(e)throw e;c(null),v.push("/login")}catch(e){throw f(e instanceof Error?e.message:"Logout failed"),e}},error:g,clearError:()=>{f(null)},isAdmin:!!d&&((null==(t=d.user_metadata)?void 0:t.role)==="admin"||"qdelarambelje@gmail.com"===d.email||"admin@bvfloriande.nl"===d.email)};return(0,s.jsx)(o.Provider,{value:x,children:r})}function c(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2523:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var s=r(5155),a=r(2115),n=r(9434);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-background px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...i})});i.displayName="Input"},2881:(e,t,r)=>{"use strict";r.d(t,{y:()=>a});var s=r(6927);let a={supabase:s.N,async resetPassword(e){let{error:t}=await s.N.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(t)throw t;return{success:!0}},async signUp(e,t,r){if(t.length<8)throw Error("Wachtwoord moet minimaal 8 tekens lang zijn");let{data:a,error:n}=await s.N.auth.signUp({email:e,password:t,options:{data:r}});if(n)throw n;return{data:a,error:null}},async signIn(e,t){let{data:r,error:a}=await s.N.auth.signInWithPassword({email:e,password:t});if(a)throw a;return r},async signOut(){let{error:e}=await s.N.auth.signOut();if(e)throw e},async getCurrentUser(){let{data:{user:e},error:t}=await s.N.auth.getUser();if(t)throw t;return e},resendConfirmation:async e=>(console.log("Email confirmation is disabled for development"),{success:!0}),async updatePassword(e){if(e.length<8)throw Error("Wachtwoord moet minimaal 8 tekens lang zijn");let{error:t}=await s.N.auth.updateUser({password:e});if(t)throw t;return{success:!0}}}},4229:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},5057:(e,t,r)=>{"use strict";r.d(t,{J:()=>i});var s=r(5155),a=r(2115),n=r(9434);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("label",{ref:t,className:(0,n.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),...a})});i.displayName="Label"},5365:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>o,TN:()=>c,XL:()=>d});var s=r(5155),a=r(2115),n=r(2085),i=r(9434);let l=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=a.forwardRef((e,t)=>{let{className:r,variant:a,...n}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(l({variant:a}),r),...n})});o.displayName="Alert";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})});d.displayName="AlertTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",r),...a})});c.displayName="AlertDescription"},6101:(e,t,r)=>{"use strict";r.d(t,{s:()=>i,t:()=>n});var s=r(2115);function a(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function n(...e){return t=>{let r=!1,s=e.map(e=>{let s=a(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():a(e[t],null)}}}}function i(...e){return s.useCallback(n(...e),e)}},6117:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var s=r(5155),a=r(2115),n=r(5695),i=r(1090);function l(e){let{children:t,requiredRole:r,redirectTo:l="/login"}=e,{user:o,loading:d}=(0,i.A)(),c=(0,n.useRouter)();return((0,a.useEffect)(()=>{if(console.log("\uD83D\uDEE1️ ProtectedRoute check:",{user:!!o,loading:d,userEmail:null==o?void 0:o.email}),!d)if(o)console.log("✅ User authenticated in ProtectedRoute:",o.email);else{console.log("\uD83D\uDEAB No user found in ProtectedRoute, redirecting to:",l),setTimeout(()=>{c.replace(l)},100);return}},[o,d,c,r,l]),d)?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Authenticatie controleren..."})]})})}):o?(0,s.jsx)(s.Fragment,{children:t}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Doorsturen naar login..."})]})})})}},6695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>i,aR:()=>l,wL:()=>u});var s=r(5155),a=r(2115),n=r(9434);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},8351:(e,t,r)=>{Promise.resolve().then(r.bind(r,245))},8883:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},9708:(e,t,r)=>{"use strict";r.d(t,{DX:()=>l,TL:()=>i});var s=r(2115),a=r(6101),n=r(5155);function i(e){let t=function(e){let t=s.forwardRef((e,t)=>{let{children:r,...n}=e;if(s.isValidElement(r)){var i;let e,l,o=(i=r,(l=(e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.ref:(l=(e=Object.getOwnPropertyDescriptor(i,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.props.ref:i.props.ref||i.ref),d=function(e,t){let r={...t};for(let s in t){let a=e[s],n=t[s];/^on[A-Z]/.test(s)?a&&n?r[s]=(...e)=>{let t=n(...e);return a(...e),t}:a&&(r[s]=a):"style"===s?r[s]={...a,...n}:"className"===s&&(r[s]=[a,n].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==s.Fragment&&(d.ref=t?(0,a.t)(t,o):o),s.cloneElement(r,d)}return s.Children.count(r)>1?s.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=s.forwardRef((e,r)=>{let{children:a,...i}=e,l=s.Children.toArray(a),o=l.find(d);if(o){let e=o.props.children,a=l.map(t=>t!==o?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,n.jsx)(t,{...i,ref:r,children:s.isValidElement(e)?s.cloneElement(e,void 0,a):null})}return(0,n.jsx)(t,{...i,ref:r,children:a})});return r.displayName=`${e}.Slot`,r}var l=i("Slot"),o=Symbol("radix.slottable");function d(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}}},e=>{var t=t=>e(e.s=t);e.O(0,[1778,4982,4797,360,8441,1684,7358],()=>t(8351)),_N_E=e.O()}]);