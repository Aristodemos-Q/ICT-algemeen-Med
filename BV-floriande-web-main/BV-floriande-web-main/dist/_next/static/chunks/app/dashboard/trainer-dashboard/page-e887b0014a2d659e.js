(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4062],{646:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1090:(e,r,s)=>{"use strict";s.d(r,{AuthProvider:()=>c,A:()=>d});var t=s(5155),n=s(2115),a=s(2881),i=s(5695);async function o(e){let r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let n=1;n<=s;n++)try{return await e()}catch(e){if(r=e,console.warn("Attempt ".concat(n," failed:"),r.message),r.message.includes("Invalid login credentials")||r.message.includes("User not found")||r.message.includes("Invalid email")||r.message.includes("Signup is disabled"))throw r;if((r.message.includes("Failed to fetch")||r.message.includes("Network connection failed")||r.message.includes("timeout")||r.message.includes("Request timeout")||"TypeError"===r.name||"AbortError"===r.name)&&n<s){console.log("Retrying in ".concat(t,"ms... (").concat(n,"/").concat(s,")")),await new Promise(e=>setTimeout(e,t)),t*=1.5;continue}break}throw r}let l=(0,n.createContext)(void 0);function c(e){var r;let{children:s}=e,[c,d]=(0,n.useState)(null),[u,m]=(0,n.useState)(!0),[g,h]=(0,n.useState)(null),[p,f]=(0,n.useState)(!1),x=(0,i.useRouter)();(0,n.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:s},error:t}=await a.y.supabase.auth.getSession();if(t)console.error("Error getting session:",t),h("Failed to initialize authentication");else if(e){var r;d(null!=(r=null==s?void 0:s.user)?r:null)}}catch(r){console.error("Error initializing auth:",r),e&&h("Failed to initialize authentication")}finally{e&&(m(!1),f(!0))}})();let{data:{subscription:r}}=a.y.supabase.auth.onAuthStateChange(async(r,s)=>{var t,n;console.log("\uD83D\uDD04 Auth state change:",{event:r,hasUser:!!(null==s?void 0:s.user),userEmail:null==s||null==(t=s.user)?void 0:t.email}),e&&(d(null!=(n=null==s?void 0:s.user)?n:null),m(!1),"SIGNED_IN"===r&&(null==s?void 0:s.user)?(console.log("✅ SIGNED_IN event - checking for redirect"),setTimeout(()=>{"/login"===window.location.pathname?(console.log("\uD83C\uDFE0 No custom redirect detected, going to dashboard"),x.push("/dashboard")):console.log("✅ Custom redirect detected, staying on current page")},300)):"SIGNED_OUT"===r&&(console.log("\uD83D\uDEAA SIGNED_OUT event - redirecting to login"),x.push("/login")))});return()=>{e=!1,r.unsubscribe()}},[x]);let v={user:c,loading:u,login:async(e,r)=>{try{var s;h(null),m(!0),console.log("AuthContext login attempt:",{email:e});try{let e=await fetch("".concat("https://tuqlyoimberycjtdkivm.supabase.co","/rest/v1/"),{method:"HEAD",headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR1cWx5b2ltYmVyeWNqdGRraXZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzMjcwNTIsImV4cCI6MjA2NTkwMzA1Mn0.O1zFRbvkHq-1HMAHFXGU8uNVGcEgVCDESYWVbWwQZfI"}});console.log("Connectivity test successful:",e.status)}catch(e){throw console.error("Connectivity test failed:",e),Error("Kan geen verbinding maken met de server. Controleer je internetverbinding.")}let{data:t,error:n}=await o(async()=>await a.y.supabase.auth.signInWithPassword({email:e,password:r}),3,1e3);if(console.log("AuthContext login response:",{hasUser:!!t.user,userEmail:null==(s=t.user)?void 0:s.email,hasSession:!!t.session,errorMessage:null==n?void 0:n.message}),n){if(console.error("Login error details:",{message:n.message,status:n.status,name:n.name}),n.message.includes("Invalid login credentials"))throw Error("Ongeldige inloggegevens. Controleer je e-mailadres en wachtwoord.");if(n.message.includes("Too many requests"))throw Error("Te veel inlogpogingen. Probeer het over een paar minuten opnieuw.");if(n.message.includes("User not found"))throw Error("Geen account gevonden met dit e-mailadres. Registreer eerst een account.");else if(n.message.includes("Invalid email"))throw Error("Ongeldig e-mailadres format.");else if(n.message.includes("Signup is disabled"))throw Error("Registratie is momenteel uitgeschakeld. Neem contact op met de beheerder.");else if(n.message.includes("Failed to fetch")||n.message.includes("Network connection failed"))throw Error("Netwerkverbinding mislukt. Controleer je internetverbinding en probeer opnieuw.");else throw Error("Login fout: ".concat(n.message))}if(!t.user)throw Error("Login failed: No user data received");console.log("✅ Login successful, setting user:",t.user.email),d(t.user),console.log("⏳ Waiting for onAuthStateChange to handle redirect...")}catch(r){let e=r instanceof Error?r.message:"Login failed";throw console.error("AuthContext login error:",e),h(e),m(!1),r}},logout:async()=>{try{h(null);let{error:e}=await a.y.supabase.auth.signOut();if(e)throw e;d(null),x.push("/login")}catch(e){throw h(e instanceof Error?e.message:"Logout failed"),e}},error:g,clearError:()=>{h(null)},isAdmin:!!c&&((null==(r=c.user_metadata)?void 0:r.role)==="admin"||"qdelarambelje@gmail.com"===c.email||"admin@bvfloriande.nl"===c.email)};return(0,t.jsx)(l.Provider,{value:v,children:s})}function d(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1154:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2881:(e,r,s)=>{"use strict";s.d(r,{y:()=>n});var t=s(6927);let n={supabase:t.N,async resetPassword(e){let{error:r}=await t.N.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(r)throw r;return{success:!0}},async signUp(e,r,s){if(r.length<8)throw Error("Wachtwoord moet minimaal 8 tekens lang zijn");let{data:n,error:a}=await t.N.auth.signUp({email:e,password:r,options:{data:s}});if(a)throw a;return{data:n,error:null}},async signIn(e,r){let{data:s,error:n}=await t.N.auth.signInWithPassword({email:e,password:r});if(n)throw n;return s},async signOut(){let{error:e}=await t.N.auth.signOut();if(e)throw e},async getCurrentUser(){let{data:{user:e},error:r}=await t.N.auth.getUser();if(r)throw r;return e},resendConfirmation:async e=>(console.log("Email confirmation is disabled for development"),{success:!0}),async updatePassword(e){if(e.length<8)throw Error("Wachtwoord moet minimaal 8 tekens lang zijn");let{error:r}=await t.N.auth.updateUser({password:e});if(r)throw r;return{success:!0}}}},3109:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("trending-up",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},3904:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},4186:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4326:(e,r,s)=>{Promise.resolve().then(s.bind(s,7776))},4516:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4616:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5339:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},5695:(e,r,s)=>{"use strict";var t=s(8999);s.o(t,"usePathname")&&s.d(r,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(r,{useSearchParams:function(){return t.useSearchParams}})},6117:(e,r,s)=>{"use strict";s.d(r,{A:()=>o});var t=s(5155),n=s(2115),a=s(5695),i=s(1090);function o(e){let{children:r,requiredRole:s,redirectTo:o="/login"}=e,{user:l,loading:c}=(0,i.A)(),d=(0,a.useRouter)();return((0,n.useEffect)(()=>{if(console.log("\uD83D\uDEE1️ ProtectedRoute check:",{user:!!l,loading:c,userEmail:null==l?void 0:l.email}),!c)if(l)console.log("✅ User authenticated in ProtectedRoute:",l.email);else{console.log("\uD83D\uDEAB No user found in ProtectedRoute, redirecting to:",o),setTimeout(()=>{d.replace(o)},100);return}},[l,c,d,s,o]),c)?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Authenticatie controleren..."})]})})}):l?(0,t.jsx)(t.Fragment,{children:r}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Doorsturen naar login..."})]})})})}},6126:(e,r,s)=>{"use strict";s.d(r,{E:()=>o});var t=s(5155);s(2115);var n=s(2085),a=s(9434);let i=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:r,variant:s,...n}=e;return(0,t.jsx)("div",{className:(0,a.cn)(i({variant:s}),r),...n})}},6695:(e,r,s)=>{"use strict";s.d(r,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>i,aR:()=>o,wL:()=>u});var t=s(5155),n=s(2115),a=s(9434);let i=n.forwardRef((e,r)=>{let{className:s,...n}=e;return(0,t.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})});i.displayName="Card";let o=n.forwardRef((e,r)=>{let{className:s,...n}=e;return(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",s),...n})});o.displayName="CardHeader";let l=n.forwardRef((e,r)=>{let{className:s,...n}=e;return(0,t.jsx)("h3",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})});l.displayName="CardTitle";let c=n.forwardRef((e,r)=>{let{className:s,...n}=e;return(0,t.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",s),...n})});c.displayName="CardDescription";let d=n.forwardRef((e,r)=>{let{className:s,...n}=e;return(0,t.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",s),...n})});d.displayName="CardContent";let u=n.forwardRef((e,r)=>{let{className:s,...n}=e;return(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",s),...n})});u.displayName="CardFooter"},7580:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},7776:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>E});var t=s(5155),n=s(2115),a=s(6874),i=s.n(a),o=s(1090),l=s(6117),c=s(6695),d=s(285),u=s(6126),m=s(4616),g=s(5339),h=s(3904),p=s(1154),f=s(7580),x=s(9074);let v=(0,s(9946).A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var b=s(646),y=s(4186),N=s(4516),j=s(3109),w=s(6927);let A=(e,r)=>{throw console.error(r||"Database error:",e),Error(r||e.message||"Er is een onbekende databasefout opgetreden")},S={users:{async getCurrentUser(){let{data:{user:e},error:r}=await w.N.auth.getUser();if(r)return A(r,"Fout bij het ophalen van de huidige gebruiker"),null;if(!e)return null;let{data:s,error:t}=await w.N.from("users").select("*").eq("id",e.id).single();return t?(A(t,"Fout bij het ophalen van het gebruikersprofiel"),null):s},async isAdmin(){let e=await this.getCurrentUser();return(null==e?void 0:e.role)==="admin"},async getAllUsers(){let{data:e,error:r}=await w.N.from("users").select("*");return r?(A(r,"Fout bij het ophalen van gebruikers"),[]):e||[]},async getAllTrainers(){var e,r;try{console.log("bvf-queries: Fetching all trainers...");let{data:r,error:s}=await w.N.from("users").select("*").eq("role","trainer");if(s){if(console.error("Error in bvf-queries getAllTrainers:",{message:s.message||"No error message",details:s.details||"No error details",hint:s.hint||"No error hint",code:s.code||"No error code",error:s}),null==(e=s.message)?void 0:e.includes("infinite recursion"))return console.error("\uD83D\uDD25 CRITICAL: RLS infinite recursion detected in bvf-queries!"),console.error("\uD83D\uDCCB SOLUTION: Apply the RLS fix from RLS-FIX-MANUAL-INSTRUCTIONS.md"),console.error("⚠️  Returning empty trainers array to prevent app crash"),[];return A(s,"Fout bij het ophalen van trainers"),[]}return console.log("bvf-queries: Successfully fetched ".concat((null==r?void 0:r.length)||0," trainers")),r||[]}catch(e){return console.error("Exception in bvf-queries getAllTrainers:",e),e instanceof Error&&(null==(r=e.message)?void 0:r.includes("infinite recursion"))&&console.error("\uD83D\uDD25 CRITICAL: RLS infinite recursion exception in bvf-queries!"),[]}}},groups:{async getAllGroups(){var e,r;try{console.log("bvf-queries getAllGroups: Fetching all groups...");let{data:r,error:s}=await w.N.from("groups").select("*").order("created_at",{ascending:!1});if(s){if(console.error("Error in bvf-queries getAllGroups:",{message:s.message||"No error message",details:s.details||"No error details",hint:s.hint||"No error hint",code:s.code||"No error code",error:s}),(null==(e=s.message)?void 0:e.includes("infinite recursion"))||"42P17"===s.code)return console.error("\uD83D\uDD25 CRITICAL: RLS infinite recursion detected in bvf-queries getAllGroups!"),console.error("\uD83D\uDCCB SOLUTION: Apply the RLS fix from RLS-FIX-MANUAL-INSTRUCTIONS.md"),console.error("\uD83D\uDD17 Go to: Supabase Dashboard → SQL Editor"),console.error("⚠️  Returning empty groups array to prevent app crash"),[];return console.error("❌ Non-recursion database error occurred in bvf-queries getAllGroups"),A(s,"Fout bij het ophalen van groepen"),[]}return console.log("✅ Successfully fetched ".concat((null==r?void 0:r.length)||0," groups in bvf-queries")),r||[]}catch(e){if(console.error("Exception in bvf-queries getAllGroups:",{error:e,errorMessage:e instanceof Error?e.message:"Unknown error",errorStack:e instanceof Error?e.stack:void 0,errorType:typeof e}),e instanceof Error&&(null==(r=e.message)?void 0:r.includes("infinite recursion")))return console.error("\uD83D\uDD25 CRITICAL: RLS infinite recursion exception detected in bvf-queries getAllGroups!"),console.error("\uD83D\uDCCB NEXT STEPS:"),console.error("  1. Go to Supabase Dashboard"),console.error("  2. Open SQL Editor"),console.error("  3. Apply the fix from RLS-FIX-MANUAL-INSTRUCTIONS.md"),console.error("⚠️  Returning empty groups array to prevent app crash"),[];return console.error("❌ Exception occurred in bvf-queries getAllGroups, returning empty groups array"),[]}},async createGroup(e){var r,s,t;try{console.log("bvf-queries createGroup: Creating new group:",{name:e.name,created_by:e.created_by});let{data:s,error:t}=await w.N.from("groups").insert([e]).select().single();if(t){if(console.error("Error in bvf-queries createGroup:",{message:t.message||"No error message",details:t.details||"No error details",hint:t.hint||"No error hint",code:t.code||"No error code",groupData:e,error:t}),(null==(r=t.message)?void 0:r.includes("infinite recursion"))||"42P17"===t.code)throw console.error("\uD83D\uDD25 CRITICAL: RLS infinite recursion detected in bvf-queries createGroup!"),console.error("\uD83D\uDCCB SOLUTION: Apply the RLS fix from RLS-FIX-MANUAL-INSTRUCTIONS.md"),console.error("\uD83D\uDD17 Go to: Supabase Dashboard → SQL Editor"),console.error("⚠️  Cannot create group due to RLS recursion issue"),Error("Database configuration error. Please contact system administrator.");throw console.error("❌ Non-recursion database error occurred in bvf-queries createGroup"),A(t,"Fout bij het aanmaken van de groep"),t}return console.log("✅ Successfully created group in bvf-queries: ".concat(s.name," (ID: ").concat(s.id,")")),s}catch(r){if(console.error("Exception in bvf-queries createGroup:",{error:r,errorMessage:r instanceof Error?r.message:"Unknown error",errorStack:r instanceof Error?r.stack:void 0,errorType:typeof r,groupData:e}),r instanceof Error&&(null==(s=r.message)?void 0:s.includes("infinite recursion"))){console.error("\uD83D\uDD25 CRITICAL: RLS infinite recursion exception detected in bvf-queries createGroup!"),console.error("\uD83D\uDCCB NEXT STEPS:");let e=(null==(t="https://tuqlyoimberycjtdkivm.supabase.co".split("://")[1])?void 0:t.split(".")[0])||"your-project-id";throw console.error("  1. Go to Supabase Dashboard: https://supabase.com/dashboard/project/".concat(e)),console.error("  2. Open SQL Editor"),console.error("  3. Apply the fix from RLS-FIX-MANUAL-INSTRUCTIONS.md"),Error("Database configuration error. Please contact system administrator.")}throw r}},async getGroupWithMembers(e){let{data:r,error:s}=await w.N.from("groups").select("*").eq("id",e).single();if(s)return A(s,"Fout bij het ophalen van de groep"),null;let{data:t,error:n}=await w.N.from("group_members").select("\n        member_id,\n        members (*)\n      ").eq("group_id",e);if(n)return A(n,"Fout bij het ophalen van groepsleden"),null;let{data:a,error:i}=await w.N.from("group_evaluations").select("*").eq("group_id",e).order("evaluation_date",{ascending:!1}).limit(1);return i?(A(i,"Fout bij het ophalen van groepsevaluaties"),null):{...r,members:(null==t?void 0:t.map(e=>e.members))||[],latestEvaluation:(null==a?void 0:a.length)?a[0]:null}},async getGroupWithMembersAndTrainers(e){let{data:r,error:s}=await w.N.from("groups").select("*").eq("id",e).single();if(s)return A(s,"Fout bij het ophalen van de groep"),null;let{data:t,error:n}=await w.N.from("group_members").select("\n        member_id,\n        members (*)\n      ").eq("group_id",e);if(n)return A(n,"Fout bij het ophalen van groepsleden"),null;let{data:a,error:i}=await w.N.from("group_trainers").select("\n        *,\n        trainer:users!trainer_id(*),\n        assigned_by_user:users!assigned_by(*)\n      ").eq("group_id",e);if(i)return A(i,"Fout bij het ophalen van groepstrainers"),null;let{data:o,error:l}=await w.N.from("group_evaluations").select("*").eq("group_id",e).order("evaluation_date",{ascending:!1}).limit(1);return l?(A(l,"Fout bij het ophalen van groepsevaluaties"),null):{...r,members:(null==t?void 0:t.map(e=>e.members))||[],trainers:a||[],latestEvaluation:(null==o?void 0:o.length)?o[0]:null}}},exercises:{async getAllExercises(){let{data:e,error:r}=await w.N.from("exercises").select("*");return r?(A(r,"Fout bij het ophalen van oefeningen"),[]):e||[]},async getCompletedExercisesForSession(e,r){let{data:s,error:t}=await w.N.from("completed_exercises").select("\n        *,\n        exercises (*)\n      ").eq("session_id",e).eq("group_id",r);return t?(A(t,"Fout bij het ophalen van uitgevoerde oefeningen"),[]):s||[]},async getPendingExercisesForGroup(e){let{data:r,error:s}=await w.N.from("group_pending_exercises").select("*").eq("group_id",e);return s?(A(s,"Fout bij het ophalen van niet-uitgevoerde oefeningen"),[]):r||[]},async getDifficultySummaryForGroup(e){let{data:r,error:s}=await w.N.from("group_difficulty_summary").select("*").eq("group_id",e);return s?(A(s,"Fout bij het ophalen van moeilijkheidsoverzicht"),[]):r||[]}},sessions:{async getSessionsForGroup(e){let{data:r,error:s}=await w.N.from("sessions").select("\n        *,\n        session_trainers (\n          users (\n            id,\n            name\n          )\n        ),\n        locations (\n          name,\n          address\n        )\n      ").eq("group_id",e).gte("start_time",new Date(Date.now()-2592e6).toISOString()).order("start_time",{ascending:!0});return s?(A(s,"Fout bij het ophalen van sessies"),[]):r||[]},async getSessionsForTrainer(e){let{data:r,error:s}=await w.N.from("session_trainers").select("\n        sessions (\n          *,\n          groups (\n            id,\n            name\n          ),\n          locations (\n            name,\n            address\n          )\n        )\n      ").eq("user_id",e);return s?(A(s,"Fout bij het ophalen van trainersessies"),[]):(null==r?void 0:r.map(e=>e.sessions))||[]},async getAttendanceForSession(e){let{data:r,error:s}=await w.N.from("attendance").select("\n        *,\n        members (\n          id,\n          name\n        ),\n        users (\n          name\n        )\n      ").eq("session_id",e);return s?(A(s,"Fout bij het ophalen van aanwezigheidsgegevens"),[]):r||[]}},dashboard:{async getTrainerDashboardData(e){try{var r;console.log("Getting dashboard data for trainer:",e);let[s,t]=await Promise.all([w.N.from("session_trainers").select("\n            sessions!inner (\n              *,\n              groups (\n                id,\n                name\n              ),\n              locations (\n                name,\n                address\n              )\n            )\n          ").eq("user_id",e).gte("sessions.start_time",new Date().toISOString()).order("sessions.start_time",{ascending:!0}).limit(5),w.N.from("groups").select("*").eq("created_by",e)]);return console.log("Upcoming sessions query result:",s),console.log("Groups query result:",t),{upcomingSessions:(null==(r=s.data)?void 0:r.map(e=>e.sessions).filter(Boolean))||[],groups:t.data||[]}}catch(e){return console.error("Dashboard query error:",e),A(e,"Fout bij het ophalen van dashboard gegevens"),{upcomingSessions:[],groups:[]}}}}};var k=s(5495);function E(){var e;let{user:r}=(0,o.A)(),[s,a]=(0,n.useState)({upcomingSessions:[],totalGroups:0,totalSessions:0,completedExercises:0,activeMembers:0,recentActivities:[]}),[w,A]=(0,n.useState)(!0),[E,I]=(0,n.useState)(null);return(0,n.useEffect)(()=>{(async()=>{if(null==r?void 0:r.id)try{var e,s,t;A(!0),I(null);let n={upcomingSessions:[],totalGroups:0,totalSessions:0,completedExercises:0,activeMembers:0,recentActivities:[]},i=[];try{if("function"==typeof(null==S||null==(s=S.dashboard)?void 0:s.getTrainerDashboardData)){let e=await S.dashboard.getTrainerDashboardData(r.id);n={upcomingSessions:Array.isArray(e.upcomingSessions)?e.upcomingSessions.map(e=>{var r,s,t,n,a;return{id:(null==e?void 0:e.id)||"unknown",title:(null==e||null==(r=e.groups)?void 0:r.name)||(null==e?void 0:e.title)||"Training",date:(null==e||null==(s=e.start_time)?void 0:s.split("T")[0])||new Date().toISOString().split("T")[0],time:(null==e||null==(n=e.start_time)||null==(t=n.split("T")[1])?void 0:t.substring(0,5))||"00:00",location:(null==e||null==(a=e.locations)?void 0:a.name)||"Locatie onbekend",participants:(null==e?void 0:e.participants_count)||0}}):[],totalGroups:e.totalGroups||0,totalSessions:e.totalSessions||0,completedExercises:e.completedExercises||0,activeMembers:e.activeMembers||0,recentActivities:[]}}}catch(e){console.warn("Could not load dashboard data from bvfQueries:",e)}try{console.log("Fetching groups data for user:",{id:r.id,role:r.role,idType:typeof r.id,idLength:null==(t=r.id)?void 0:t.length,isValidUUID:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r.id||"")}),i="admin"===r.role?await k.H6.getAllGroups():await k.H6.getTrainerGroups(r.id),Array.isArray(i)||(console.warn("Groups data is not an array:",i),i=[]),console.log("Successfully loaded groups data:",{count:i.length})}catch(e){console.error("Error loading groups data:",{error:e,userId:r.id,userRole:r.role,errorMessage:e instanceof Error?e.message:"Unknown error",errorStack:e instanceof Error?e.stack:void 0,errorType:typeof e,errorStringified:JSON.stringify(e,null,2)}),e&&"object"==typeof e&&(console.error("Error object keys:",Object.keys(e)),console.error("Error object values:",Object.values(e))),i=[]}a({totalGroups:(null==i?void 0:i.length)||n.totalGroups,totalSessions:n.totalSessions||(null==(e=n.upcomingSessions)?void 0:e.length)||0,completedExercises:n.completedExercises,activeMembers:n.activeMembers,upcomingSessions:n.upcomingSessions,recentActivities:[{id:"1",type:"info",description:"Dashboard geladen",time:"Nu"}]})}catch(e){console.error("Error loading dashboard data:",e),I("Kon dashboard gegevens niet laden. Probeer de pagina te verversen."),a({upcomingSessions:[],totalGroups:0,totalSessions:0,completedExercises:0,activeMembers:0,recentActivities:[{id:"1",type:"error",description:"Fout bij laden van gegevens",time:"Nu"}]})}finally{A(!1)}})()},[null==r?void 0:r.id,null==r?void 0:r.role]),(0,t.jsx)(l.A,{children:(0,t.jsxs)("div",{className:"container mx-auto p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-primary",children:"Trainer Dashboard"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Welkom terug, ",(null==r||null==(e=r.user_metadata)?void 0:e.name)||(null==r?void 0:r.email)]})]}),(0,t.jsx)("div",{className:"space-x-2",children:(0,t.jsx)(d.$,{asChild:!0,children:(0,t.jsxs)(i(),{href:"/dashboard/calendar",children:[(0,t.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Nieuwe Sessie"]})})})]}),E&&(0,t.jsx)(c.Zp,{className:"mb-6 border-red-200 bg-red-50",children:(0,t.jsx)(c.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(g.A,{className:"h-5 w-5 text-red-500 mr-2"}),(0,t.jsx)("p",{className:"text-red-600",children:E})]}),(0,t.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),className:"text-red-600 border-red-300 hover:bg-red-50",children:[(0,t.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Opnieuw proberen"]})]})})}),w?(0,t.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,t.jsx)(p.A,{className:"h-8 w-8 animate-spin"}),(0,t.jsx)("span",{className:"ml-2",children:"Dashboard laden..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ZB,{className:"text-sm font-medium",children:"Groepen"}),(0,t.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:s.totalGroups}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Actieve trainingsgroepen"})]})]}),(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ZB,{className:"text-sm font-medium",children:"Sessies"}),(0,t.jsx)(x.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:s.totalSessions}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Aankomende sessies"})]})]}),(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ZB,{className:"text-sm font-medium",children:"Oefeningen"}),(0,t.jsx)(v,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:s.completedExercises}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Voltooid deze maand"})]})]}),(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ZB,{className:"text-sm font-medium",children:"Leden"}),(0,t.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:s.activeMembers}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Actieve leden"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(c.Zp,{className:"lg:col-span-1",children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsxs)(c.ZB,{className:"flex items-center",children:["Snelle Acties",(0,t.jsx)("span",{className:"ml-2 inline-flex items-center px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Actief"})]}),(0,t.jsx)(c.BT,{children:"Veelgebruikte functies - Klik om direct naar de pagina te gaan"})]}),(0,t.jsxs)(c.Wu,{className:"space-y-4",children:[(0,t.jsx)(d.$,{asChild:!0,className:"w-full justify-start",size:"lg",children:(0,t.jsxs)(i(),{href:"/dashboard/exercises",children:[(0,t.jsx)(v,{className:"h-4 w-4 mr-2"}),"Oefening Registreren"]})}),(0,t.jsx)(d.$,{asChild:!0,variant:"outline",className:"w-full justify-start",size:"lg",children:(0,t.jsxs)(i(),{href:"/dashboard/attendance",children:[(0,t.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Aanwezigheid Bijhouden"]})}),(0,t.jsx)(d.$,{asChild:!0,variant:"outline",className:"w-full justify-start",size:"lg",children:(0,t.jsxs)(i(),{href:"/dashboard/groups",children:[(0,t.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Groepen Beheren"]})}),(0,t.jsx)(d.$,{asChild:!0,variant:"outline",className:"w-full justify-start",size:"lg",children:(0,t.jsxs)(i(),{href:"/dashboard/calendar",children:[(0,t.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Agenda Bekijken"]})}),!1]})]}),(0,t.jsxs)(c.Zp,{className:"lg:col-span-2",children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsx)(c.ZB,{children:"Aankomende Trainingen"}),(0,t.jsx)(c.BT,{children:"Je volgende geplande sessies"})]}),(0,t.jsx)(c.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[s.upcomingSessions.map(e=>(0,t.jsx)("div",{className:"border rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium",children:e.title}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(x.A,{className:"h-3 w-3"}),e.date?new Date(e.date).toLocaleDateString("nl-NL"):"Datum onbekend"]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(y.A,{className:"h-3 w-3"}),e.time||"Tijd onbekend"]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(N.A,{className:"h-3 w-3"}),e.location]})]})]}),(0,t.jsxs)(u.E,{variant:"secondary",children:[e.participants," deelnemers"]})]})},e.id)),0===s.upcomingSessions.length&&(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(x.A,{className:"h-8 w-8 mx-auto mb-2"}),(0,t.jsx)("p",{children:"Geen geplande sessies"}),(0,t.jsx)(d.$,{asChild:!0,className:"mt-4",children:(0,t.jsxs)(i(),{href:"/dashboard/calendar",children:[(0,t.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Plan een sessie"]})})]})]})})]})]}),(0,t.jsxs)(c.Zp,{className:"mt-6",children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsx)(c.ZB,{children:"Recente Activiteiten"}),(0,t.jsx)(c.BT,{children:"Overzicht van je laatste acties"})]}),(0,t.jsx)(c.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[s.recentActivities&&s.recentActivities.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-4 p-3 border rounded-lg",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("exercise"===e.type?"bg-blue-500":"attendance"===e.type?"bg-green-500":"bg-gray-500")}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm",children:e.description}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.time})]})]},e.id)),(!s.recentActivities||0===s.recentActivities.length)&&(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(j.A,{className:"h-8 w-8 mx-auto mb-2"}),(0,t.jsx)("p",{children:"Geen recente activiteiten"})]})]})})]})]})]})})}},9074:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])}},e=>{var r=r=>e(e.s=r);e.O(0,[1778,4982,9037,360,8441,1684,7358],()=>r(4326)),_N_E=e.O()}]);