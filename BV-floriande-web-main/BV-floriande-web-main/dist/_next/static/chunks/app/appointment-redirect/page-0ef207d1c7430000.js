(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4719],{1090:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>c,A:()=>u});var n=r(5155),o=r(2115),s=r(2881),i=r(5695);async function a(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let o=1;o<=r;o++)try{return await e()}catch(e){if(t=e,console.warn("Attempt ".concat(o," failed:"),t.message),t.message.includes("Invalid login credentials")||t.message.includes("User not found")||t.message.includes("Invalid email")||t.message.includes("Signup is disabled"))throw t;if((t.message.includes("Failed to fetch")||t.message.includes("Network connection failed")||t.message.includes("timeout")||t.message.includes("Request timeout")||"TypeError"===t.name||"AbortError"===t.name)&&o<r){console.log("Retrying in ".concat(n,"ms... (").concat(o,"/").concat(r,")")),await new Promise(e=>setTimeout(e,n)),n*=1.5;continue}break}throw t}let l=(0,o.createContext)(void 0);function c(e){var t;let{children:r}=e,[c,u]=(0,o.useState)(null),[d,h]=(0,o.useState)(!0),[g,m]=(0,o.useState)(null),[f,w]=(0,o.useState)(!1),v=(0,i.useRouter)();(0,o.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:r},error:n}=await s.y.supabase.auth.getSession();if(n)console.error("Error getting session:",n),m("Failed to initialize authentication");else if(e){var t;u(null!=(t=null==r?void 0:r.user)?t:null)}}catch(t){console.error("Error initializing auth:",t),e&&m("Failed to initialize authentication")}finally{e&&(h(!1),w(!0))}})();let{data:{subscription:t}}=s.y.supabase.auth.onAuthStateChange(async(t,r)=>{var n,o;console.log("\uD83D\uDD04 Auth state change:",{event:t,hasUser:!!(null==r?void 0:r.user),userEmail:null==r||null==(n=r.user)?void 0:n.email}),e&&(u(null!=(o=null==r?void 0:r.user)?o:null),h(!1),"SIGNED_IN"===t&&(null==r?void 0:r.user)?(console.log("✅ SIGNED_IN event - checking for redirect"),setTimeout(()=>{"/login"===window.location.pathname?(console.log("\uD83C\uDFE0 No custom redirect detected, going to dashboard"),v.push("/dashboard")):console.log("✅ Custom redirect detected, staying on current page")},300)):"SIGNED_OUT"===t&&(console.log("\uD83D\uDEAA SIGNED_OUT event - redirecting to login"),v.push("/login")))});return()=>{e=!1,t.unsubscribe()}},[v]);let p={user:c,loading:d,login:async(e,t)=>{try{var r;m(null),h(!0),console.log("AuthContext login attempt:",{email:e});try{let e=await fetch("".concat("https://tuqlyoimberycjtdkivm.supabase.co","/rest/v1/"),{method:"HEAD",headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR1cWx5b2ltYmVyeWNqdGRraXZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzMjcwNTIsImV4cCI6MjA2NTkwMzA1Mn0.O1zFRbvkHq-1HMAHFXGU8uNVGcEgVCDESYWVbWwQZfI"}});console.log("Connectivity test successful:",e.status)}catch(e){throw console.error("Connectivity test failed:",e),Error("Kan geen verbinding maken met de server. Controleer je internetverbinding.")}let{data:n,error:o}=await a(async()=>await s.y.supabase.auth.signInWithPassword({email:e,password:t}),3,1e3);if(console.log("AuthContext login response:",{hasUser:!!n.user,userEmail:null==(r=n.user)?void 0:r.email,hasSession:!!n.session,errorMessage:null==o?void 0:o.message}),o){if(console.error("Login error details:",{message:o.message,status:o.status,name:o.name}),o.message.includes("Invalid login credentials"))throw Error("Ongeldige inloggegevens. Controleer je e-mailadres en wachtwoord.");if(o.message.includes("Too many requests"))throw Error("Te veel inlogpogingen. Probeer het over een paar minuten opnieuw.");if(o.message.includes("User not found"))throw Error("Geen account gevonden met dit e-mailadres. Registreer eerst een account.");else if(o.message.includes("Invalid email"))throw Error("Ongeldig e-mailadres format.");else if(o.message.includes("Signup is disabled"))throw Error("Registratie is momenteel uitgeschakeld. Neem contact op met de beheerder.");else if(o.message.includes("Failed to fetch")||o.message.includes("Network connection failed"))throw Error("Netwerkverbinding mislukt. Controleer je internetverbinding en probeer opnieuw.");else throw Error("Login fout: ".concat(o.message))}if(!n.user)throw Error("Login failed: No user data received");console.log("✅ Login successful, setting user:",n.user.email),u(n.user),console.log("⏳ Waiting for onAuthStateChange to handle redirect...")}catch(t){let e=t instanceof Error?t.message:"Login failed";throw console.error("AuthContext login error:",e),m(e),h(!1),t}},logout:async()=>{try{m(null);let{error:e}=await s.y.supabase.auth.signOut();if(e)throw e;u(null),v.push("/login")}catch(e){throw m(e instanceof Error?e.message:"Logout failed"),e}},error:g,clearError:()=>{m(null)},isAdmin:!!c&&((null==(t=c.user_metadata)?void 0:t.role)==="admin"||"qdelarambelje@gmail.com"===c.email||"admin@bvfloriande.nl"===c.email)};return(0,n.jsx)(l.Provider,{value:p,children:r})}function u(){let e=(0,o.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1576:(e,t,r)=>{Promise.resolve().then(r.bind(r,8669))},2881:(e,t,r)=>{"use strict";r.d(t,{y:()=>o});var n=r(6927);let o={supabase:n.N,async resetPassword(e){let{error:t}=await n.N.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(t)throw t;return{success:!0}},async signUp(e,t,r){if(t.length<8)throw Error("Wachtwoord moet minimaal 8 tekens lang zijn");let{data:o,error:s}=await n.N.auth.signUp({email:e,password:t,options:{data:r}});if(s)throw s;return{data:o,error:null}},async signIn(e,t){let{data:r,error:o}=await n.N.auth.signInWithPassword({email:e,password:t});if(o)throw o;return r},async signOut(){let{error:e}=await n.N.auth.signOut();if(e)throw e},async getCurrentUser(){let{data:{user:e},error:t}=await n.N.auth.getUser();if(t)throw t;return e},resendConfirmation:async e=>(console.log("Email confirmation is disabled for development"),{success:!0}),async updatePassword(e){if(e.length<8)throw Error("Wachtwoord moet minimaal 8 tekens lang zijn");let{error:t}=await n.N.auth.updateUser({password:e});if(t)throw t;return{success:!0}}}},5695:(e,t,r)=>{"use strict";var n=r(8999);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},6927:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});var n=r(4982),o=r(9509);console.log("=== SUPABASE CLIENT INITIALIZATION ==="),console.log("All env vars:",Object.keys(o.env).filter(e=>e.startsWith("NEXT_PUBLIC_"))),console.log("NODE_ENV:","production");let s="https://tuqlyoimberycjtdkivm.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR1cWx5b2ltYmVyeWNqdGRraXZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzMjcwNTIsImV4cCI6MjA2NTkwMzA1Mn0.O1zFRbvkHq-1HMAHFXGU8uNVGcEgVCDESYWVbWwQZfI";if(console.log("NEXT_PUBLIC_SUPABASE_URL:",s?"SET ("+s.substring(0,20)+"...)":"MISSING"),console.log("NEXT_PUBLIC_SUPABASE_ANON_KEY:",i?"SET ("+i.substring(0,20)+"...)":"MISSING"),!s||!i)throw console.error("Supabase environment variables are missing!"),console.error("Current environment:","production"),console.error("NEXT_PUBLIC_SUPABASE_URL:",s?"Set":"Missing"),console.error("NEXT_PUBLIC_SUPABASE_ANON_KEY:",i?"Set":"Missing"),console.error("Please check your .env.local file to ensure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set."),console.error("Make sure to restart your development server after adding environment variables."),Error("Missing required environment variables: NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY. Please set them in your .env.local file and restart the server.");if(s&&!s.startsWith("http"))throw console.error("Invalid Supabase URL format!"),Error("Supabase URL must start with http:// or https://");if(i&&(!i.startsWith("ey")||2!==(i.match(/\./g)||[]).length))throw console.error("Invalid Supabase API key format!"),console.error('API key should be a JWT token (start with "ey" and contain two periods)'),Error("Invalid Supabase API key format. Please check your .env.local file.");{let e=console.log,t=console.warn;console.log=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];let o=r.join(" ");o.includes("GoTrueClient")||o.includes("#_")||e.apply(console,r)},console.warn=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];let o=r.join(" ");o.includes("GoTrueClient")||o.includes("#_")||t.apply(console,r)}}let a=(0,n.UU)(s,i,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,debug:!1},global:{headers:{"X-Client-Info":"bv-floriande-web"},fetch:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new AbortController,n=setTimeout(()=>r.abort(),15e3);try{let o=await fetch(e,{...t,signal:r.signal,headers:{"Content-Type":"application/json",...t.headers}});return clearTimeout(n),o}catch(e){if(clearTimeout(n),e instanceof Error&&"AbortError"===e.name)throw Error("Request timeout - please check your internet connection");if(e instanceof TypeError&&e.message.includes("Failed to fetch"))throw Error("Network connection failed. Please check your internet connection and try again.");throw e}}},db:{schema:"public"}})},8669:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var n=r(5155),o=r(2115),s=r(5695),i=r(1090);function a(){let e=(0,s.useRouter)(),{user:t,loading:r}=(0,i.A)();return(0,o.useEffect)(()=>{r||(t?e.push("/appointment-booking"):e.push("/login?redirect=/appointment-booking&from=home"))},[t,r,e]),(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-green-50 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:"Even geduld..."}),(0,n.jsx)("p",{className:"text-gray-500 mt-2",children:r?"Controleren van inlogstatus...":"Doorverwijzen..."})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[4982,8441,1684,7358],()=>t(1576)),_N_E=e.O()}]);